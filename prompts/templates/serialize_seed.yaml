name: serialize_seed
description: Convert seed brief into SeedOutput artifact

system: |
  You are converting a SEED stage brief into a structured SeedOutput artifact.

  ## Scoped ID Format (CRITICAL)

  All IDs use type prefixes for disambiguation. Copy IDs EXACTLY as shown in the brief:
  - Entity IDs: `entity::butler`, `entity::manor`
  - Dilemma IDs: `dilemma::host_benevolent_or_selfish`
  - Path IDs: `path::host_benevolent_or_selfish__protector` (hierarchical format: dilemma__answer)

  The manifest shows which IDs are valid - copy them with their prefixes.

  ## Schema Overview

  SeedOutput contains six main sections that must be populated from the brief:

  ### 1. entities (Entity Decisions)
  For EVERY entity from brainstorm (characters, locations, objects, AND factions), create an EntityDecision:
  ```json
  {
    "entity_id": "entity::butler",
    "disposition": "retained"
  }
  ```
  IMPORTANT: Include ALL entity types - don't skip factions!

  ### 2. dilemmas (Dilemma Decisions)
  For each dilemma from brainstorm, create a DilemmaDecision:
  ```json
  {
    "dilemma_id": "dilemma::host_benevolent_or_selfish",
    "explored": ["protector", "manipulator"],
    "unexplored": []
  }
  ```
  NOTES:
  - The default path answer (is_default_path=true) MUST be in "explored", never in "unexplored".
  - **Arc Count**: At least 2 dilemmas should have BOTH answers in "explored" for proper IF branching.
  - Dilemmas with only canonical answer explored don't contribute to branching.

  ### 3. paths (Story Paths)
  For each explored answer, create a Path:
  ```json
  {
    "path_id": "path::host_benevolent_or_selfish__protector",
    "name": "Human Readable Path Name",
    "dilemma_id": "dilemma::host_benevolent_or_selfish",
    "answer_id": "protector",
    "unexplored_answer_ids": ["manipulator"],
    "path_importance": "major",
    "description": "What this path is about",
    "consequence_ids": ["host_revealed"]
  }
  ```

  ### 4. consequences (Narrative Consequences)
  For each path, create its Consequences:
  ```json
  {
    "consequence_id": "host_revealed",
    "path_id": "path::host_benevolent_or_selfish__protector",
    "description": "What happens narratively",
    "narrative_effects": ["story effect 1", "story effect 2"]
  }
  ```

  ### 5. initial_beats (Initial Beats - 2-4 per path)
  Create 2-4 InitialBeat objects PER PATH. With 3 paths, expect 6-12 beats total.
  ```json
  {
    "beat_id": "host_motive_beat_01",
    "summary": "What happens in this beat",
    "paths": ["path::host_benevolent_or_selfish__protector"],
    "dilemma_impacts": [
      {
        "dilemma_id": "dilemma::host_benevolent_or_selfish",
        "effect": "advances",
        "note": "Explanation of the impact"
      }
    ],
    "entities": ["entity::butler", "entity::guest"],
    "location": "entity::manor",
    "location_alternatives": ["entity::garden"]
  }
  ```

  ### 6. convergence_sketch
  ```json
  {
    "convergence_points": ["where paths should merge"],
    "residue_notes": ["differences that persist after convergence"]
  }
  ```

  ## Mapping Rules

  | Brief Section      | SeedOutput Field    |
  |--------------------|---------------------|
  | Entity Decisions   | entities            |
  | Dilemma Decisions  | dilemmas            |
  | Paths              | paths               |
  | Consequences       | consequences        |
  | Initial Beats      | initial_beats       |
  | Convergence Sketch | convergence_sketch  |

  ## Guidelines

  - Extract ALL information from the brief - do not invent new details
  - Use snake_case for all IDs
  - Copy IDs EXACTLY as shown in the brief, INCLUDING the type prefix
  - Every path must reference a valid dilemma_id (with `dilemma::` prefix) and answer_id
  - Every consequence must reference a valid path_id (with `path::` prefix)
  - Create 2-4 initial_beats PER PATH (not 1 per path!)
  - Every initial_beat must reference valid path IDs (with `path::` prefix)
  - path_importance must be exactly "major" or "minor" (lowercase)
  - effect must be exactly "advances", "reveals", "commits", or "complicates"
  - disposition must be exactly "retained" or "cut"

  ## Output

  Return ONLY valid JSON matching SeedOutput schema with all six sections.

components: []
