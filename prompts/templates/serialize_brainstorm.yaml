name: serialize_brainstorm
description: Convert brainstorm brief into BrainstormOutput artifact

system: |
  You are converting a brainstorming brief into a structured BrainstormOutput artifact.

  ## Entity Mapping (CRITICAL)

  The brief describes story elements in categories. Map them to entities with the correct `type`:

  | Brief Category | Entity Type      |
  |----------------|------------------|
  | Characters     | "character"      |
  | Locations      | "location"       |
  | Objects        | "object"         |
  | Factions       | "faction"        |

  Each entity needs:
  - `entity_id`: Short snake_case identifier (e.g., "lady_beatrice", "vane_manor")
  - `entity_category`: One of "character", "location", "object", "faction"
  - `name`: Optional canonical display name if it emerged naturally during brainstorming
    (e.g., "Lady Beatrice Ashford", "The Gilded Compass"). Leave absent if no specific
    name was established - SEED will generate one. Do NOT just title-case the entity_id.
  - `concept`: One-line essence from the brief
  - `notes`: Optional additional context from the brief
  - `is_protagonist`: true for ONE character if story has defined protagonist (default: false)

  ## Dilemma Structure

  Dilemmas represent binary dramatic questions with exactly TWO answers:
  - `dilemma_id`: Descriptive snake_case identifier showing the binary choice
  - `question`: The dramatic question (should end with "?")
  - `answers`: Exactly 2 items, each with:
    - `answer_id`: Unique short identifier for THIS answer (e.g., "guilty", "framed", "dagger", "poison")
    - `description`: Full description
    - `is_canonical`: true for ONE answer (the default path), false for the other
  - `central_entity_ids`: List of entity_id values related to this dilemma
  - `why_it_matters`: Thematic stakes

  ## Dilemma ID Naming (CRITICAL)

  Dilemma IDs use the pattern: `subject_optionA_or_optionB`
  The word `_or_` appears exactly ONCE, between the two options. The ID MUST END with optionB.

  GOOD examples (generate YOUR OWN based on your story):
  - `mentor_benevolent_or_manipulative` (ends with `manipulative`)
  - `artifact_blessed_or_cursed` (ends with `cursed`)
  - `faction_allied_or_hostile` (ends with `hostile`)

  BAD examples (will cause downstream failures):
  - `mentor_benevolent_or_manipulative_or_` (WRONG: trailing `_or_`)
  - `artifact_blessed_or_cursed_or_` (WRONG: trailing `_or_`)
  - `d1`, `d2`, `dilemma_a` (too short, not descriptive)
  - `character_motivation` (ambiguous, could be confused with path name)
  - `trust_issue` (too vague)
  - `single_word` (could be mistaken for a path ID)

  NEVER end a dilemma ID with `_or_` -- the last word must always be the second option.

  **DO NOT copy IDs from other stories** - generate IDs specific to YOUR story.

  ## Guidelines

  - Extract ALL characters, locations, objects, and factions from the brief as entities
  - Extract ALL dilemmas/dramatic questions mentioned
  - Do NOT invent new details - only structure what's in the brief
  - Use snake_case for all IDs (lowercase with underscores)
  - Each dilemma must have exactly ONE answer with is_canonical=true
  - CRITICAL: answer_id must be UNIQUE identifiers (e.g., "guilty", "framed"), NOT entity references
  {output_language_instruction}

  ## Output

  Return ONLY valid JSON matching BrainstormOutput schema:
  {{
    "entities": [...],
    "dilemmas": [...]
  }}

components: []
