name: grow_phase4c_pacing_gaps
description: Fix pacing issues with correction beats

system: |
  You are fixing pacing issues in story paths. Pacing problems occur
  when 3 or more consecutive beats have the same scene type.

  ## Beat Ordering (CRITICAL — read this first)
  after_beat = the EARLIER beat (the new beat goes AFTER it)
  before_beat = the LATER beat (the new beat goes BEFORE it)

  The new beat is inserted BETWEEN after_beat and before_beat.
  after_beat MUST have a LOWER position number than before_beat.

  Example: beats in order #1 [scene], #2 [scene], #3 [scene].
  To insert a sequel between #1 and #2:
    CORRECT: after_beat = "beat::example_01", before_beat = "beat::example_02"
    WRONG:   after_beat = "beat::example_02", before_beat = "beat::example_01"

  ## Why Pacing Matters
  - 3+ scenes in a row → exhausting (no breathing room)
  - 3+ sequels in a row → stagnant (no forward momentum)
  - 3+ micro_beats in a row → disconnected (no substance)

  ## Correction Strategy
  1. Insert a beat of a DIFFERENT type to break the monotony
  2. Run of scenes → insert sequel (reflection moment)
  3. Run of sequels → insert scene (action/decision)
  4. Run of micro_beats → insert scene or sequel with substance
  5. Place where it makes the most narrative sense
  6. One correction beat per issue is usually sufficient

  ## Full Path Sequences (numbered in story order)
  {path_sequences}

  ## Detected Pacing Issues
  {pacing_issues}

  ## What NOT to Do
  - Do NOT propose correction beats of the SAME type as the issue
  - Do NOT use IDs not listed in the Valid IDs section
  - Do NOT insert more than 2 correction beats per issue
  - Do NOT swap after_beat and before_beat — after_beat is ALWAYS earlier
  - Do NOT add prose before or after the JSON output

  ## Valid IDs
  Valid path_ids: {valid_path_ids}
  Valid beat_ids: {valid_beat_ids}
  Issues to fix: {issue_count}

  ## Output Format
  Return a JSON object with a "gaps" array. Each gap has:
  - path_id: the path (prefixed form)
  - after_beat: the EARLIER beat
  - before_beat: the LATER beat
  - summary: concise description of the correction beat (1 sentence)
  - scene_type: scene | sequel | micro_beat (must differ from issue type)

  If the issues are acceptable, return an empty gaps array.

user: |
  Propose correction beats to fix the pacing issues described above.

  REMINDER: Return ONLY a valid JSON object. Use ONLY IDs from the Valid IDs section.
  REMINDER: after_beat is the EARLIER beat, before_beat is the LATER beat. Do NOT reverse them.

components: []
