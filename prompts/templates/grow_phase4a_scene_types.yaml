name: grow_phase4a_scene_types
description: Classify beats by scene type, narrative function, and exit mood

system: |
  You are classifying story beats on three axes.

  ## Scene Type (how the prose flows)
  - **scene**: Active conflict, action, confrontation, or decision moment.
  - **sequel**: Reaction, reflection, or processing of what happened.
  - **micro_beat**: Brief transition (travel, time skip, minor observation).

  ## Narrative Function (dramatic role)
  - **introduce**: Establishes something new (character, setting, threat).
  - **develop**: Deepens understanding of established elements.
  - **complicate**: Adds obstacles, reversals, or new stakes.
  - **confront**: Direct engagement with the central tension.
  - **resolve**: Settles a question, closes a thread, reveals truth.

  Scene type and function are independent: a sequel can "complicate"
  (processing reveals new stakes), a scene can "introduce" (action
  establishes a new threat).

  ## Exit Mood (2-3 words, 2-40 characters)
  A short emotional phrase for how the reader feels leaving this beat.
  GOOD: "bitter resolve" (14 chars)
  BAD: "The reader feels growing unease about what comes next" (too long)

  ## Quick Reference
  - Beats with dilemma_impacts → scene (drives conflict forward)
  - Opening/setup beats → scene + "introduce"
  - Beats after major decisions → sequel
  - Short connecting beats with no named characters → micro_beat
  - When in doubt between scene and sequel → prefer scene
  - Do NOT assign the same narrative_function to 4+ consecutive beats

  ## Beats to Classify
  {beat_summaries}

  ## What NOT to Do
  - Do NOT use IDs not listed in the Valid IDs section
  - Do NOT leave any beat unclassified
  - Do NOT write exit_mood as a full sentence
  - Do NOT add prose before or after the JSON output

  ## Valid IDs
  Valid beat_ids (use ONLY these): {valid_beat_ids}
  Total beats: {beat_count}

  ## Output Format
  Return a JSON object with a "tags" array. Each tag has:
  - beat_id: the beat ID being classified
  - scene_type: scene | sequel | micro_beat
  - narrative_function: introduce | develop | complicate | confront | resolve
  - exit_mood: 2-3 word emotional descriptor (2-40 chars)

  Classify ALL beats listed above. Every beat must get exactly one tag.

  Example (do not copy these IDs -- use the real IDs listed above):
  {{
    "tags": [
      {{
        "beat_id": "beat::market_encounter",
        "scene_type": "scene",
        "narrative_function": "introduce",
        "exit_mood": "curious unease"
      }}
    ]
  }}

user: |
  Classify each beat by scene type, narrative function, and exit mood.

  REMINDER: Return ONLY a valid JSON object. Use ONLY IDs from the Valid IDs
  section. Every beat needs scene_type + narrative_function + exit_mood.
  Do NOT assign the same narrative_function to 4+ consecutive beats.
  When in doubt between scene and sequel, prefer scene.
  Do NOT add prose before or after the JSON.

components: []
